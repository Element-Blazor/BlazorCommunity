@inherits LayoutComponentBase
<BAdmin Menus="Menus" NavigationTitle="Blazui社区后台管理" EnablePermissionMenus="false"></BAdmin>

@code{

    [Inject]
    NavigationManager NavigationManager { get; set; }
    protected List<MenuModel> Menus { get; set; } = new List<MenuModel>();
    [Inject]
    public AuthenticationStateProvider AuthenticationStateProvider { get; set; }
    protected override void OnInitialized()
    {
        Menus.Add(new MenuModel()
        {
            Label = "用户管理",
            Icon = "el-icon-user",
            Flex = true,
            Name = "User",
            Title = "用户管理",
            Route = "/manage/user"
        });
        Menus.Add(new MenuModel()
        {
            Label = "帖子管理",
            Icon = "el-icon-position",
            Flex = true,
            Name = "帖子管理",
            Title = "帖子管理",
            Children = new List<MenuModel>()
{
                new MenuModel()
        {
            Label = "主贴管理",
            Icon = "el-icon-position",
            Flex = true,
            Name = "主贴管理",
            Title = "主贴管理",
            Route = "/manage/topic"
        },  new MenuModel()
        {
            Label = "回帖管理",
            Icon = "el-icon-position",
            Flex = true,
            Name = "回帖管理",
            Title = "回帖管理",
            Route = "/manage/reply"
        }
            }
        });
        Menus.Add(new MenuModel()
        {
            Label = "版本管理",
            Icon = "el-icon-cherry",
            Flex = true,
            Name = "version",
            Title = "版本管理",
            Route = "/manage/ver"
        });
    }

    protected async override Task OnAfterRenderAsync(bool firstRender)
    {
        await base.OnAfterRenderAsync(firstRender);
        if (firstRender)
        {
            var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
            if (authState.User.Identity.IsAuthenticated)
                NavigationManager.NavigateTo("/manage/user");
        }
    }
}